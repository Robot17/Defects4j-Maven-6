***************
*** 228,236 ****
              throw new UnknownKeyException("Column key (" + columnKey 
                      + ") not recognised.");
          }
-         if (row >= 0) {
          KeyedObjects rowData = (KeyedObjects) this.rows.get(row);
-             return rowData.getObject(columnKey);
          }
          else {
              return null;
--- 228,237 ----
              throw new UnknownKeyException("Column key (" + columnKey 
                      + ") not recognised.");
          }
          KeyedObjects rowData = (KeyedObjects) this.rows.get(row);
+         int index = rowData.getIndex(columnKey);
+         if (index >= 0) {
+             return rowData.getObject(index);
          }
          else {
              return null;
***************
*** 315,322 ****
          }
          
          // 2. check whether the column is now empty.
          
          
      }
  
      /**
--- 316,344 ----
          }
          
          // 2. check whether the column is now empty.
+         allNull = true;
          
+         for (int item = 0, itemCount = this.rows.size(); item < itemCount; 
+              item++) {
+             row = (KeyedObjects) this.rows.get(item);
+             int columnIndex = row.getIndex(columnKey);
+             if (columnIndex >= 0 && row.getObject(columnIndex) != null) {
+                 allNull = false;
+                 break;
+             }
+         }
          
+         if (allNull) {
+             for (int item = 0, itemCount = this.rows.size(); item < itemCount; 
+                  item++) {
+                 row = (KeyedObjects) this.rows.get(item);
+                 int columnIndex = row.getIndex(columnKey);
+                 if (columnIndex >= 0) {
+                     row.removeValue(columnIndex);
+                 }
+             }
+             this.columnKeys.remove(columnKey);
+         }
      }
  
      /**
***************
*** 342,347 ****
       */
      public void removeRow(Comparable rowKey) {
          int index = getRowIndex(rowKey);
          removeRow(index);
      }
  
--- 364,373 ----
       */
      public void removeRow(Comparable rowKey) {
          int index = getRowIndex(rowKey);
+         if (index < 0) {
+             throw new UnknownKeyException("Row key (" + rowKey 
+                     + ") not recognised.");
+         }
          removeRow(index);
      }
  
***************
*** 375,381 ****
          Iterator iterator = this.rows.iterator();
          while (iterator.hasNext()) {
              KeyedObjects rowData = (KeyedObjects) iterator.next();
-                 rowData.removeValue(columnKey);
          }
          this.columnKeys.remove(columnKey);
      }
--- 401,410 ----
          Iterator iterator = this.rows.iterator();
          while (iterator.hasNext()) {
              KeyedObjects rowData = (KeyedObjects) iterator.next();
+             int i = rowData.getIndex(columnKey);
+             if (i >= 0) {
+                 rowData.removeValue(i);
+             }
          }
          this.columnKeys.remove(columnKey);
      }
