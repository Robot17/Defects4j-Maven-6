***************
*** 242,253 ****
          }
  
          if (firstTime) {
-           final double[] scale;
            if (vecAbsoluteTolerance == null) {
-               scale = new double[y0.length];
-               java.util.Arrays.fill(scale, scalAbsoluteTolerance);
              } else {
-               scale = vecAbsoluteTolerance;
              }
            hNew = initializeStep(equations, forward, getOrder(), scale,
                                  stepStart, y, yDotK[0], yTmp, yDotK[1]);
--- 242,256 ----
          }
  
          if (firstTime) {
+           final double[] scale = new double[y0.length];
            if (vecAbsoluteTolerance == null) {
+               for (int i = 0; i < scale.length; ++i) {
+                 scale[i] = scalAbsoluteTolerance + scalRelativeTolerance * Math.abs(y[i]);
+               }
              } else {
+               for (int i = 0; i < scale.length; ++i) {
+                 scale[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * Math.abs(y[i]);
+               }
              }
            hNew = initializeStep(equations, forward, getOrder(), scale,
                                  stepStart, y, yDotK[0], yTmp, yDotK[1]);
