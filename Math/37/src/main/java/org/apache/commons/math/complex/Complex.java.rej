***************
*** 1015,1023 ****
       * @since 1.2
       */
      public Complex tan() {
-         if (isNaN) {
              return NaN;
          }
  
          double real2 = 2.0 * real;
          double imaginary2 = 2.0 * imaginary;
--- 1015,1029 ----
       * @since 1.2
       */
      public Complex tan() {
+         if (isNaN || Double.isInfinite(real)) {
              return NaN;
          }
+         if (imaginary > 20.0) {
+             return createComplex(0.0, 1.0);
+         }
+         if (imaginary < -20.0) {
+             return createComplex(0.0, -1.0);
+         }
  
          double real2 = 2.0 * real;
          double imaginary2 = 2.0 * imaginary;
***************
*** 1060,1068 ****
       * @since 1.2
       */
      public Complex tanh() {
-         if (isNaN) {
              return NaN;
          }
          double real2 = 2.0 * real;
          double imaginary2 = 2.0 * imaginary;
          double d = FastMath.cosh(real2) + FastMath.cos(imaginary2);
--- 1066,1080 ----
       * @since 1.2
       */
      public Complex tanh() {
+         if (isNaN || Double.isInfinite(imaginary)) {
              return NaN;
          }
+         if (real > 20.0) {
+             return createComplex(1.0, 0.0);
+         }
+         if (real < -20.0) {
+             return createComplex(-1.0, 0.0);
+         }
          double real2 = 2.0 * real;
          double imaginary2 = 2.0 * imaginary;
          double d = FastMath.cosh(real2) + FastMath.cos(imaginary2);
