***************
*** 776,782 ****
          if (v.length != nCols) {
              throw new IllegalArgumentException("vector has wrong length");
          }
-         final double[] out = new double[v.length];
          for (int row = 0; row < nRows; row++) {
              final double[] dataRow = data[row];
              double sum = 0;
--- 776,782 ----
          if (v.length != nCols) {
              throw new IllegalArgumentException("vector has wrong length");
          }
+         final double[] out = new double[nRows];
          for (int row = 0; row < nRows; row++) {
              final double[] dataRow = data[row];
              double sum = 0;
